<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html {
            font-family: Arial;
            font-size: 25px;
            padding: 40px;
        }
        div {
            margin: 20px;
        }
    </style>
</head>
<body>
        <div id="output">JavaScript Course</div>
        <input type="button" id="myBtn" value="load data">
        <div id="country"></div>
        <input type="text" id="myGuess">
        <input type="button" value="guess" id="guess">
        <div id="result"></div>

        <script>
            // countries api =  restcountries.eu/rest/v2/all
            var myBtn    = document.getElementById('myBtn');
            var guessBtn = document.getElementById('guess');
            var myGuess  = document.getElementById('myGuess');
            var result   = document.getElementById('result');
            var country  = document.getElementById('country');

            var countries   = [];
            var pickCountry = '';
            var img = new Image(200,250);
            window.onload   = init;

            function init() {
                randomcountryService(function (response) {
                    countries = JSON.parse(response);
                    myBtn.addEventListener('click',function () {
                        message(result,'');
                        pickRandomCountry(countries);
                        country.innerHTML = shuffleCounntryWords(pickCountry.name).toLowerCase() + "<br>";
                        country.appendChild(img);
                        console.log(pickCountry.name);
                        guessBtn.addEventListener('click', guess);
                    });
                });


            }

            function randomcountryService(callback) {
                var xHR = new XMLHttpRequest();
                // xHR.onload = rOutput;
                xHR.open('GET','https://restcountries.eu/rest/v2/all',true);
                xHR.send();
                xHR.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        callback(this.responseText);
                    }
                    else {
                        return false;
                    }
                }
            }
            function pickRandomCountry(randomCountry) {
                pickCountry = randomCountry[Math.floor(Math.random()*randomCountry.length)];
                img.src = pickCountry.flag;
            }

            function shuffleCounntryWords(w) {
                var response = '';
                w = w.split('');
                while(w.length > 0) {
                    response += w.splice(Math.floor(Math.random()*w.length),1);
                }
                return response;
            }

            function guess() {
                if (myGuess.value.length > 0) {
                    if (myGuess.value.toLowerCase() == pickCountry.name.toLowerCase()) {
                        message(result,'You Correct!')
                    }
                    else {
                        message(result, 'bommer , Try again');
                    }
                } else {
                    message(result, 'Please write a Valid Guess');
                }

            }

            function message(el,mes) {
                el.innerHTML = mes;
            }


        </script>
</body>
</html>